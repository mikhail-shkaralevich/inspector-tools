<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Concrete Yield Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 50px;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
        h2 {
            text-align: center;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        input[type="text"] { /* Changed from type="number" to type="text" */
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        input[readonly] {
            background-color: #e9ecef;
            cursor: not-allowed;
        }
        .unit-selection {
            margin-bottom: 15px;
            text-align: center;
        }
        .unit-selection label {
            display: inline-block;
            margin-right: 10px;
        }
        .weight-fields, .volume-fields {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        .weight-fields input, .volume-fields input {
            flex: 1;
        }
        .weight-fields span, .volume-fields span {
            font-weight: bold;
        }
        .result-field {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        .result-field input {
            flex: 1;
        }
        .result-field span {
            font-weight: bold;
        }
        .note {
            font-size: 0.9em;
            color: #555;
            margin-top: -10px;
            margin-bottom: 15px;
        }
        .contractor-label {
            color: red;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        .si-weight-field, .si-volume-field {
            display: none;
        }
        .last-field-container {
            display: block;
        }
        .reset-button {
            width: 100%;
            padding: 10px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        .reset-button:hover {
            background-color: #c82333;
        }
        .keypad {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 3px;
            max-width: 300px;
            margin: 0 0 15px 0;
            text-align: center;
        }
        .key {
            padding: 10px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            cursor: pointer;
            font-size: 16px;
        }
        .key:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Concrete Yield Calculator</h2>
    <form id="yieldForm">
        <div class="unit-selection">
            <label>
                <input type="radio" name="unit" value="English" checked> English
            </label>
            <label>
                <input type="radio" name="unit" value="SI"> SI 
            </label>
        </div>

        <div id="englishFields">
            <label for="totalWeight">Total Weight of Concrete:</label>
            <div class="weight-fields">
                <input type="text" id="pounds" placeholder="Pounds" onfocus="setActiveInput(this)">
                <span>lbs</span>
                <span>or</span>
                <input type="text" id="tons" placeholder="Tons" onfocus="setActiveInput(this)">
                <span>tons</span>
            </div>

            <label for="measuredDensity">Measured Density of the Freshly Mixed Concrete:</label>
            <div style="display: flex; align-items: center; gap: 10px;">
                <input type="text" id="measuredDensityEnglish" onfocus="setActiveInput(this)" required>
                <span>lbs/ft³</span>
            </div>

            <label for="designedVolume">Designed Volume of Concrete the Batch was to Produce:</label>
            <div class="volume-fields">
                <input type="text" id="designedVolumeFt" placeholder="Cubic Feet" onfocus="setActiveInput(this)">
                <span>ft³</span>
                <span>or</span>
                <input type="text" id="designedVolumeYd" placeholder="Cubic Yards" onfocus="setActiveInput(this)">
                <span>yd³</span>
            </div>

            <div class="keypad">
                <div class="key" onclick="addNumber('1')">1</div>
                <div class="key" onclick="addNumber('2')">2</div>
                <div class="key" onclick="addNumber('3')">3</div>
                <div class="key" onclick="addNumber('4')">4</div>
                <div class="key" onclick="addNumber('5')">5</div>
                <div class="key" onclick="addNumber('6')">6</div>
                <div class="key" onclick="addNumber('7')">7</div>
                <div class="key" onclick="addNumber('8')">8</div>
                <div class="key" onclick="addNumber('9')">9</div>
                <div class="key" onclick="addNumber('0')">0</div>
                <div class="key" onclick="addNumber('.')">.</div>
                <div class="key" onclick="clearInput()">C</div>
            </div>

            <label for="yield">Yield:</label>
            <div class="result-field">
                <input type="text" id="yieldEnglish" readonly>
                <span>ft³</span>
            </div>

            <label for="relativeYield">Relative Yield:</label>
            <div class="result-field">
                <input type="text" id="relativeYieldEnglish" readonly>
                <span>Actual Volume / Design Volume</span>
            </div>

            <div class="note">
                <div>Ry > 1.00: Indicates an excess of concrete was produced.</div>
                <div>Ry < 1.00: Indicates the concrete batch was short of the designed volume.</div>
                <div>Ry = 1.00: Indicates the delivered concrete matches the designed volume.</div>
            </div>

            <div class="last-field-container">
                <label for="actualOverDesignVolume">ft³ of actual volume of concrete / yd³ of design volume of concrete:</label>
                <div class="contractor-label">This is loosely referred by Contractor or Supplier as Yield:</div>
                <div class="result-field">
                    <input type="text" id="actualOverDesignVolumeEnglish" readonly>
                    <span>ft³/yd³</span>
                </div>
            </div>

            <button type="button" class="reset-button" onclick="resetEnglishFields()">Reset</button>
        </div>

        <div id="siFields" style="display: none;">
            <label for="totalWeight">Total Weight of Concrete:</label>
            <div class="weight-fields">
                <input type="text" id="kilograms" placeholder="Kilograms" onfocus="setActiveInput(this)">
                <span>kg</span>
            </div>

            <label for="measuredDensity">Measured Density of the Freshly Mixed Concrete:</label>
            <div style="display: flex; align-items: center; gap: 10px;">
                <input type="text" id="measuredDensitySI" onfocus="setActiveInput(this)" required>
                <span>kg/m³</span>
            </div>

            <label for="designedVolume">Designed Volume of Concrete the Batch was to Produce:</label>
            <div class="volume-fields">
                <input type="text" id="designedVolumeM3" placeholder="Cubic Meters" onfocus="setActiveInput(this)">
                <span>m³</span>
            </div>

            <div class="keypad">
                <div class="key" onclick="addNumber('1')">1</div>
                <div class="key" onclick="addNumber('2')">2</div>
                <div class="key" onclick="addNumber('3')">3</div>
                <div class="key" onclick="addNumber('4')">4</div>
                <div class="key" onclick="addNumber('5')">5</div>
                <div class="key" onclick="addNumber('6')">6</div>
                <div class="key" onclick="addNumber('7')">7</div>
                <div class="key" onclick="addNumber('8')">8</div>
                <div class="key" onclick="addNumber('9')">9</div>
                <div class="key" onclick="addNumber('0')">0</div>
                <div class="key" onclick="addNumber('.')">.</div>
                <div class="key" onclick="clearInput()">C</div>
            </div>

            <label for="yield">Yield:</label>
            <div class="result-field">
                <input type="text" id="yieldSI" readonly>
                <span>m³</span>
            </div>

            <label for="relativeYield">Relative Yield:</label>
            <div class="result-field">
                <input type="text" id="relativeYieldSI" readonly>
                <span>Actual Volume / Design Volume</span>
            </div>

            <div class="note">
                <div>Ry > 1.00: Indicates an excess of concrete was produced.</div>
                <div>Ry < 1.00: Indicates the concrete batch was short of the designed volume.</div>
                <div>Ry = 1.00: Indicates the delivered concrete matches the designed volume.</div>
            </div>

            <button type="button" class="reset-button" onclick="resetSIFields()">Reset</button>
        </div>
    </form>
</div>

<script>
    const poundsInput = document.getElementById('pounds');
    const tonsInput = document.getElementById('tons');
    const kilogramsInput = document.getElementById('kilograms');
    const measuredDensityEnglish = document.getElementById('measuredDensityEnglish');
    const measuredDensitySI = document.getElementById('measuredDensitySI');
    const yieldEnglish = document.getElementById('yieldEnglish');
    const yieldSI = document.getElementById('yieldSI');
    const designedVolumeFtInput = document.getElementById('designedVolumeFt');
    const designedVolumeYdInput = document.getElementById('designedVolumeYd');
    const designedVolumeM3Input = document.getElementById('designedVolumeM3');
    const relativeYieldEnglish = document.getElementById('relativeYieldEnglish');
    const relativeYieldSI = document.getElementById('relativeYieldSI');
    const actualOverDesignVolumeEnglish = document.getElementById('actualOverDesignVolumeEnglish');
    const englishFields = document.getElementById('englishFields');
    const siFields = document.getElementById('siFields');

    let activeInput = null;

    function setActiveInput(input) {
        if (!input.readOnly) {
            activeInput = input;
        }
    }

    function addNumber(num) {
        if (activeInput) {
            let currentValue = activeInput.value || '';
            // Only allow one decimal point
            if (num === '.' && currentValue.includes('.')) {
                return;
            }
            activeInput.value = currentValue + num;
            updateRelatedField(activeInput.id);
            calculateYield();
        }
    }

    function clearInput() {
        if (activeInput) {
            activeInput.value = '';
            updateRelatedField(activeInput.id);
            calculateYield();
        }
    }

    function updateRelatedField(inputId) {
        const value = parseFloat(activeInput.value);
        if (isNaN(value)) {
            clearRelatedField(inputId);
            return;
        }

        switch (inputId) {
            case 'pounds':
                tonsInput.value = (value / 2000).toFixed(1);
                break;
            case 'tons':
                poundsInput.value = (value * 2000).toFixed(0);
                break;
            case 'designedVolumeFt':
                designedVolumeYdInput.value = (value / 27).toFixed(2);
                break;
            case 'designedVolumeYd':
                designedVolumeFtInput.value = (value * 27).toFixed(2);
                break;
        }
    }

    function clearRelatedField(inputId) {
        switch (inputId) {
            case 'pounds':
                tonsInput.value = '';
                break;
            case 'tons':
                poundsInput.value = '';
                break;
            case 'designedVolumeFt':
                designedVolumeYdInput.value = '';
                break;
            case 'designedVolumeYd':
                designedVolumeFtInput.value = '';
                break;
        }
    }

    document.querySelectorAll('input[name="unit"]').forEach((radio) => {
        radio.addEventListener('change', () => {
            if (radio.value === "English") {
                englishFields.style.display = "block";
                siFields.style.display = "none";
            } else {
                englishFields.style.display = "none";
                siFields.style.display = "block";
            }
            calculateYield();
            activeInput = null;
        });
    });

    poundsInput.addEventListener('input', () => { updateRelatedField('pounds'); calculateYield(); });
    tonsInput.addEventListener('input', () => { updateRelatedField('tons'); calculateYield(); });
    kilogramsInput.addEventListener('input', calculateYield);
    measuredDensityEnglish.addEventListener('input', calculateYield);
    measuredDensitySI.addEventListener('input', calculateYield);
    designedVolumeFtInput.addEventListener('input', () => { updateRelatedField('designedVolumeFt'); calculateYield(); });
    designedVolumeYdInput.addEventListener('input', () => { updateRelatedField('designedVolumeYd'); calculateYield(); });
    designedVolumeM3Input.addEventListener('input', calculateYield);

    function calculateYield() {
        const unitSystem = document.querySelector('input[name="unit"]:checked').value;

        if (unitSystem === "English") {
            const pounds = parseFloat(poundsInput.value);
            const measuredDensity = parseFloat(measuredDensityEnglish.value);
            const designedVolumeFt = parseFloat(designedVolumeFtInput.value);
            const designedVolumeYd = parseFloat(designedVolumeYdInput.value);

            if (isNaN(pounds) || isNaN(measuredDensity) || measuredDensity <= 0) {
                yieldEnglish.value = "Enter valid values";
                relativeYieldEnglish.value = "";
                actualOverDesignVolumeEnglish.value = "";
                return;
            }

            const yield = pounds / measuredDensity;
            const yieldInCubicYards = yield / 27;
            yieldEnglish.value = yield.toFixed(2);
            document.querySelector('#yieldEnglish + span').innerText = `ft³ or ${yieldInCubicYards.toFixed(2)} yd³`;

            let relativeYield = "";
            if (!isNaN(designedVolumeFt) && designedVolumeFt > 0) {
                relativeYield = (yield / designedVolumeFt).toFixed(2);
            }
            relativeYieldEnglish.value = relativeYield;

            let actualOverDesignVolume = "";
            if (!isNaN(designedVolumeYd) && designedVolumeYd > 0) {
                actualOverDesignVolume = (yield / designedVolumeYd).toFixed(2);
            }
            actualOverDesignVolumeEnglish.value = actualOverDesignVolume;
        } else {
            const kilograms = parseFloat(kilogramsInput.value);
            const measuredDensity = parseFloat(measuredDensitySI.value);
            const designedVolumeM3 = parseFloat(designedVolumeM3Input.value);

            if (isNaN(kilograms) || isNaN(measuredDensity) || measuredDensity <= 0) {
                yieldSI.value = "Enter valid values";
                relativeYieldSI.value = "";
                return;
            }

            const yield = kilograms / measuredDensity;
            yieldSI.value = yield.toFixed(2);
            document.querySelector('#yieldSI + span').innerText = "m³";

            let relativeYield = "";
            if (!isNaN(designedVolumeM3) && designedVolumeM3 > 0) {
                relativeYield = (yield / designedVolumeM3).toFixed(2);
            }
            relativeYieldSI.value = relativeYield;
        }
    }

    function resetEnglishFields() {
        poundsInput.value = "";
        tonsInput.value = "";
        measuredDensityEnglish.value = "";
        designedVolumeFtInput.value = "";
        designedVolumeYdInput.value = "";
        yieldEnglish.value = "";
        relativeYieldEnglish.value = "";
        actualOverDesignVolumeEnglish.value = "";
        document.querySelector('#yieldEnglish + span').innerText = "ft³";
        activeInput = null;
    }

    function resetSIFields() {
        kilogramsInput.value = "";
        measuredDensitySI.value = "";
        designedVolumeM3Input.value = "";
        yieldSI.value = "";
        relativeYieldSI.value = "";
        document.querySelector('#yieldSI + span').innerText = "m³";
        activeInput = null;
    }
</script>

</body>
</html>